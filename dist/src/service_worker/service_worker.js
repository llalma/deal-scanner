var m=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var c=(e,t,a)=>new Promise((r,i)=>{var o=n=>{try{u(a.next(n))}catch(l){i(l)}},s=n=>{try{u(a.throw(n))}catch(l){i(l)}},u=n=>n.done?r(n.value):Promise.resolve(n.value).then(o,s);u((a=a.apply(e,t)).next())});var g=m(d=>{function f(e,t){return c(this,null,function*(){const a=(yield chrome.storage.sync.get([e]))[e],r=Object.assign({},a,t);chrome.storage.sync.set({[e]:r})})}function y(e){return new Promise((t,a)=>{let r;const i=()=>{try{const s=document.evaluate(e,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;return s?(clearTimeout(r),t(s.textContent),!0):!1}catch(s){return!1}},o=()=>{(document.readyState==="interactive"||document.readyState==="complete")&&i()||setTimeout(o,100)};o()})}function p(e,t){return c(this,null,function*(){return(yield chrome.scripting.executeScript({target:{tabId:e},func:y,args:[t]}))[0].result})}function h(e){return c(this,null,function*(){const t=yield chrome.tabs.create({url:e.link,active:!0}),a=yield p(t.id,e.xpath);console.log(`Value for ${e.name} is ${a}`),chrome.tabs.remove(t.id)})}function _(e){return c(this,null,function*(){for(const[t,a]of e)yield h(a)})}chrome.runtime.onMessage.addListener((e,t,a)=>c(d,null,function*(){switch(e.type){case"scan":yield _(e.payload);break;case"update":yield f(e.payload.key,e.payload.data);break;case"remove_css":yield chrome.scripting.removeCSS({files:["src/injections/injection.css"],target:{tabId:t.tab.id}});break;default:console.error(`Not a valid message type: ${e.type}`)}}))});export default g();
