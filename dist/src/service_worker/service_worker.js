var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var r=(t,e,a)=>new Promise((n,i)=>{var o=c=>{try{u(a.next(c))}catch(l){i(l)}},s=c=>{try{u(a.throw(c))}catch(l){i(l)}},u=c=>c.done?n(c.value):Promise.resolve(c.value).then(o,s);u((a=a.apply(t,e)).next())});import{s as f}from"../helpers/helpers.js";var g=p(m=>{function d(t,e){return r(this,null,function*(){const a=(yield chrome.storage.sync.get([t]))[t],n=Object.assign({},a,e);chrome.storage.sync.set({[t]:n})})}function y(t){return new Promise((e,a)=>{let n;const i=()=>{try{const s=document.evaluate(t,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;return s?(clearTimeout(n),e(s.textContent),!0):!1}catch(s){return!1}},o=()=>{(document.readyState==="interactive"||document.readyState==="complete")&&i()||setTimeout(o,100)};o()})}function _(t,e){return r(this,null,function*(){return(yield chrome.scripting.executeScript({target:{tabId:t},func:y,args:[e]}))[0].result})}function h(t,e){return r(this,null,function*(){const a=yield chrome.tabs.create({url:e.link,active:!0}),n=yield _(a.id,e.xpath);parseFloat(f(n))<parseFloat(e.target_price)&&(yield d(t,{alert_bool:!0})),chrome.tabs.remove(a.id)})}function b(t){return r(this,null,function*(){for(const[e,a]of t)yield h(e,a)})}chrome.runtime.onMessage.addListener((t,e,a)=>r(m,null,function*(){switch(t.type){case"scan":yield b(t.payload);break;case"update":yield d(t.payload.key,t.payload.data);break;case"remove_css":yield chrome.scripting.removeCSS({files:["src/injections/injection.css"],target:{tabId:e.tab.id}});break;default:console.error(`Not a valid message type: ${t.type}`)}}))});export default g();
