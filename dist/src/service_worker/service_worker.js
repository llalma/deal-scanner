var y=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var c=(t,e,a)=>new Promise((n,i)=>{var s=r=>{try{u(a.next(r))}catch(l){i(l)}},o=r=>{try{u(a.throw(r))}catch(l){i(l)}},u=r=>r.done?n(r.value):Promise.resolve(r.value).then(s,o);u((a=a.apply(t,e)).next())});import{s as h}from"../helpers/helpers.js";var w=y(d=>{function m(t,e){return c(this,null,function*(){const a=(yield chrome.storage.sync.get([t]))[t],n=Object.assign({},a,e);chrome.storage.sync.set({[t]:n})})}f();chrome.storage.onChanged.addListener((t,e)=>c(d,null,function*(){e==="sync"&&f()}));function f(){return c(this,null,function*(){const e=Object.entries(yield chrome.storage.sync.get()).filter((a,n)=>a[1].alert_bool).length;chrome.action.setBadgeText({text:String(e)})})}function g(t){return new Promise((e,a)=>{let n;const i=()=>{try{const o=document.evaluate(t,document,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;return o?(clearTimeout(n),e(o.textContent),!0):!1}catch(o){return!1}},s=()=>{(document.readyState==="interactive"||document.readyState==="complete")&&i()||setTimeout(s,100)};s()})}function _(t,e){return c(this,null,function*(){return(yield chrome.scripting.executeScript({target:{tabId:t},func:g,args:[e]}))[0].result})}function p(t,e){return c(this,null,function*(){const a=yield chrome.tabs.create({url:e.link,active:!0}),n=yield _(a.id,e.xpath);parseFloat(h(n))<parseFloat(e.target_price)&&(yield m(t,{alert_bool:!0})),chrome.tabs.remove(a.id)})}function b(t){return c(this,null,function*(){for(const[e,a]of t)yield p(e,a)})}chrome.runtime.onMessage.addListener((t,e,a)=>c(d,null,function*(){switch(t.type){case"scan":yield b(t.payload);break;case"update":yield m(t.payload.key,t.payload.data);break;case"remove_css":yield chrome.scripting.removeCSS({files:["src/injections/injection.css"],target:{tabId:e.tab.id}});break;default:console.error(`Not a valid message type: ${t.type}`)}}))});export default w();
